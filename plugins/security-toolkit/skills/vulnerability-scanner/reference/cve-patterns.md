# CVE Patterns Reference

## Contents
- Injection vulnerabilities
- Authentication and session issues
- Cryptographic failures
- Access control problems
- Security misconfiguration

## Injection Vulnerabilities

### SQL Injection (CWE-89)

**Patterns to detect:**
```
# String concatenation in queries
"SELECT.*\+.*\$"
"SELECT.*\+.*req\."
f"SELECT.*{.*}"

# Unsafe ORM usage
.raw\(.*\$
.execute\(.*%s.*%
```

**Languages:** All with database access

### Command Injection (CWE-78)

**Patterns to detect:**
```python
# Python
os.system(user_input)
subprocess.call(cmd, shell=True)
eval(user_input)
exec(user_input)

# JavaScript
child_process.exec(userInput)
eval(userInput)
```

### XSS - Cross-Site Scripting (CWE-79)

**Patterns to detect:**
```javascript
// React
dangerouslySetInnerHTML={{__html: userInput}}

// Vanilla JS
element.innerHTML = userInput
document.write(userInput)

// Template engines without escaping
<%- userInput %>  // EJS unescaped
{{{ userInput }}} // Handlebars unescaped
```

## Authentication Issues

### Broken Authentication (CWE-287)

**Patterns:**
- Hardcoded credentials
- Weak password requirements
- Missing rate limiting
- Session tokens in URLs

### Insecure Session Management (CWE-384)

**Patterns:**
- Session ID in URL parameters
- Missing session expiration
- Predictable session tokens

## Cryptographic Failures

### Weak Cryptography (CWE-327)

**Deprecated algorithms:**
- MD5 for passwords
- SHA1 for security
- DES encryption
- RC4 cipher

**Patterns to detect:**
```
hashlib.md5
hashlib.sha1
crypto.createHash\(['"]md5
crypto.createHash\(['"]sha1
DES\.
RC4
```

### Hardcoded Secrets (CWE-798)

**Patterns:**
```
password\s*=\s*["'][^"']+["']
api_key\s*=\s*["'][^"']+["']
secret\s*=\s*["'][^"']+["']
AWS_SECRET_ACCESS_KEY
PRIVATE_KEY
```

## Access Control

### Broken Access Control (CWE-284)

**Patterns:**
- Missing authorization checks
- Direct object references without validation
- CORS misconfiguration with `*`

### Path Traversal (CWE-22)

**Patterns to detect:**
```
open\(.*\+.*user
fs.readFile\(.*\+.*req
path.join\(.*req\.
```

## Security Misconfiguration

### Debug Mode in Production

**Patterns:**
```
DEBUG\s*=\s*True
debug:\s*true
NODE_ENV.*development
```

### Missing Security Headers

Check for absence of:
- Content-Security-Policy
- X-Frame-Options
- X-Content-Type-Options
- Strict-Transport-Security
